# 实时语音识别功能使用说明

## 功能概述

本项目已成功添加实时麦克风输入功能，支持通过浏览器直接录制音频并进行实时语音识别。

## 主要特性

### 1. 实时录音识别
- 支持浏览器麦克风权限访问
- 实时音量监控和显示
- 每5秒自动发送音频块进行识别
- 实时显示识别结果

### 2. 文件上传识别
- 支持拖拽上传音频文件
- 支持多种音频格式：wav、mp3、m4a、aac、flac、webm
- 批量识别历史记录

### 3. 用户界面
- 标签页式设计，清晰分离不同功能
- 实时状态显示和错误提示
- 响应式设计，适配不同屏幕尺寸

## 使用方法

### 启动服务

1. **使用启动脚本（推荐）**：
   ```bash
   # Windows
   start_services.bat
   
   # 或手动启动
   cd backend && python app.py
   cd frontend && npm run dev
   ```

2. **访问应用**：
   - 前端地址：http://localhost:5173
   - 后端API：http://localhost:5000

### 实时录音识别

1. **权限授权**：
   - 首次使用时，浏览器会请求麦克风权限
   - 点击"允许"授权访问麦克风

2. **开始录音**：
   - 切换到"实时录音识别"标签页
   - 点击"开始录音"按钮
   - 观察音量指示器确认麦克风工作正常

3. **查看结果**：
   - 识别结果会实时显示在下方
   - 每个结果包含识别文本和时间戳
   - 可以点击"清空结果"清除历史

### 文件上传识别

1. **选择文件**：
   - 切换到"文件上传识别"标签页
   - 拖拽音频文件到上传区域或点击选择文件

2. **开始识别**：
   - 点击"上传并识别"按钮
   - 等待识别完成

3. **查看历史**：
   - 所有识别记录都会保存在数据库中
   - 可以查看、搜索历史记录

## 技术实现

### 前端技术栈
- Vue 3 + Composition API
- Element Plus UI组件库
- Web Audio API（原生录音）
- MediaRecorder API（音频录制）

### 后端技术栈
- Flask + Flask-CORS
- SQLAlchemy（数据库ORM）
- 科大讯飞语音识别API

### 核心组件

1. **SimpleRecorder.vue**：
   - 实时录音组件
   - 音量监控
   - 音频分块处理

2. **Speech.vue**：
   - 主页面组件
   - 标签页管理
   - 历史记录显示

3. **speech_recognition.py**：
   - 科大讯飞API封装
   - WebSocket连接管理
   - 音频格式转换

## 注意事项

### 浏览器兼容性
- 需要支持Web Audio API的现代浏览器
- Chrome、Firefox、Safari、Edge等主流浏览器都支持
- 建议使用Chrome浏览器获得最佳体验

### 音频格式
- 实时录音：WebM格式（Opus编码）
- 文件上传：支持多种格式
- 后端处理：统一转换为WAV格式

### 网络要求
- 需要稳定的网络连接
- 科大讯飞API需要互联网访问
- 建议在HTTPS环境下使用（生产环境）

### 性能优化
- 音频分块大小：5秒
- 采样率：16kHz
- 声道数：单声道
- 自动降噪和回声消除

## 故障排除

### 常见问题

1. **麦克风权限被拒绝**：
   - 检查浏览器地址栏的麦克风权限设置
   - 重新授权或刷新页面

2. **录音没有声音**：
   - 检查系统麦克风设置
   - 确认麦克风没有被其他应用占用

3. **识别失败**：
   - 检查网络连接
   - 确认科大讯飞API配置正确
   - 查看浏览器控制台错误信息

4. **音频上传失败**：
   - 检查文件格式是否支持
   - 确认文件大小合理（建议小于10MB）

### 调试方法

1. **浏览器开发者工具**：
   - 查看Console日志
   - 检查Network请求
   - 监控WebSocket连接

2. **后端日志**：
   - 查看Flask应用日志
   - 检查科大讯飞API响应

## 扩展功能

### 可能的改进方向

1. **语音合成**：
   - 添加文字转语音功能
   - 支持多种语音和语速

2. **多语言支持**：
   - 支持英语、日语等其他语言
   - 自动语言检测

3. **实时翻译**：
   - 集成翻译API
   - 实时语音翻译

4. **语音命令**：
   - 支持语音控制
   - 自定义语音指令

5. **云端存储**：
   - 音频文件云存储
   - 跨设备同步

## 总结

实时语音识别功能已成功集成到现有项目中，提供了完整的语音识别解决方案。用户可以通过浏览器直接进行实时录音识别，也可以上传音频文件进行批量处理。该功能具有良好的用户体验和稳定的技术实现。 